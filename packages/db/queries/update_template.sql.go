// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: update_template.sql

package queries

import (
	"context"

	"github.com/google/uuid"
)

const updateTemplate = `-- name: UpdateTemplate :one
UPDATE "public"."envs" e
SET public = $1
FROM "public"."env_aliases" ea
WHERE id IN (
    SELECT e.id FROM "public"."envs" e
    LEFT JOIN "public"."env_aliases" ea ON ea.env_id = e.id
    WHERE e.team_id = $2
    AND (e.id = $3 OR ea.alias = $3)
)
RETURNING e.id
`

type UpdateTemplateParams struct {
	Public            bool
	TeamID            uuid.UUID
	TemplateIDOrAlias string
}

func (q *Queries) UpdateTemplate(ctx context.Context, arg UpdateTemplateParams) (string, error) {
	row := q.db.QueryRow(ctx, updateTemplate, arg.Public, arg.TeamID, arg.TemplateIDOrAlias)
	var id string
	err := row.Scan(&id)
	return id, err
}

const updateTemplateBuild = `-- name: UpdateTemplateBuild :exec
UPDATE "public"."env_builds"
SET
    start_cmd = $1,
    ready_cmd = $2,
    dockerfile = $3
WHERE
    id = $4
`

type UpdateTemplateBuildParams struct {
	StartCmd   *string
	ReadyCmd   *string
	Dockerfile *string
	BuildUuid  uuid.UUID
}

func (q *Queries) UpdateTemplateBuild(ctx context.Context, arg UpdateTemplateBuildParams) error {
	_, err := q.db.Exec(ctx, updateTemplateBuild,
		arg.StartCmd,
		arg.ReadyCmd,
		arg.Dockerfile,
		arg.BuildUuid,
	)
	return err
}
