// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: get_template.sql

package queries

import (
	"context"

	"github.com/google/uuid"
)

const getTemplateByAlias = `-- name: GetTemplateByAlias :one
SELECT e.id, e.team_id, e.public
FROM public.env_aliases AS ea
JOIN public.envs AS e ON e.id = ea.env_id
WHERE ea.alias = $1
  AND ea.namespace IS NOT DISTINCT FROM $2::text
  AND e.source IN ('template', 'snapshot_template')
`

type GetTemplateByAliasParams struct {
	Alias     string
	Namespace *string
}

type GetTemplateByAliasRow struct {
	ID     string
	TeamID uuid.UUID
	Public bool
}

// Resolves a template by alias and namespace
// @alias: the alias to look up
// @namespace: the namespace to scope the lookup (NULL for promoted templates)
func (q *Queries) GetTemplateByAlias(ctx context.Context, arg GetTemplateByAliasParams) (GetTemplateByAliasRow, error) {
	row := q.db.QueryRow(ctx, getTemplateByAlias, arg.Alias, arg.Namespace)
	var i GetTemplateByAliasRow
	err := row.Scan(&i.ID, &i.TeamID, &i.Public)
	return i, err
}

const getTemplateById = `-- name: GetTemplateById :one
SELECT e.id, e.team_id, e.public
FROM public.envs AS e
WHERE e.id = $1
  AND e.source IN ('template', 'snapshot_template')
`

type GetTemplateByIdRow struct {
	ID     string
	TeamID uuid.UUID
	Public bool
}

// Looks up a template by its ID directly
// @template_id: the template ID to look up
func (q *Queries) GetTemplateById(ctx context.Context, templateID string) (GetTemplateByIdRow, error) {
	row := q.db.QueryRow(ctx, getTemplateById, templateID)
	var i GetTemplateByIdRow
	err := row.Scan(&i.ID, &i.TeamID, &i.Public)
	return i, err
}
