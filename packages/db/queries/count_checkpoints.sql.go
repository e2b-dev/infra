// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: count_checkpoints.sql

package queries

import (
	"context"

	"github.com/google/uuid"
)

const countCheckpoints = `-- name: CountCheckpoints :one
SELECT COUNT(*)::int as count
FROM "public"."snapshots" s
JOIN "public"."env_build_assignments" eba ON eba.env_id = s.env_id
WHERE s.sandbox_id = $1
AND s.team_id = $2
AND eba.tag != 'default'
`

type CountCheckpointsParams struct {
	SandboxID string
	TeamID    uuid.UUID
}

// Counts the number of checkpoints for a sandbox (for enforcing limits).
// Excludes the 'default' tag which is used for auto-pause.
func (q *Queries) CountCheckpoints(ctx context.Context, arg CountCheckpointsParams) (int32, error) {
	row := q.db.QueryRow(ctx, countCheckpoints, arg.SandboxID, arg.TeamID)
	var count int32
	err := row.Scan(&count)
	return count, err
}
