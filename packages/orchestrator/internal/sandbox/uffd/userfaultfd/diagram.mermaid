flowchart TD
A[missing page] -- write (MISSING|WRITE flag) --> B(COPY) --> C[dirty page]
A -- read (MISSING flag) --> D(COPY + MODE_WP) --> E[faulted page]
E -- write (WP|WRITE flag) --> F(remove MODE_WP) --> C